---
import Base from '../../layouts/Base.astro';
import { zodiacSigns } from '../../data/zodiac.js';

export function getStaticPaths() {
  return zodiacSigns.map((sign, i) => ({
    params: { slug: sign.slug },
    props: {
      sign,
      prev: i > 0 ? zodiacSigns[i - 1] : zodiacSigns[zodiacSigns.length - 1],
      next: i < zodiacSigns.length - 1 ? zodiacSigns[i + 1] : zodiacSigns[0],
    },
  }));
}

const { sign, prev, next } = Astro.props;
const base = import.meta.env.BASE_URL;
---
<Base title={`${sign.name} ${sign.symbol} â€” Celestial Tarot`} description={sign.description}>
  <div class="sign-header">
    <div class="symbol">{sign.symbol}</div>
    <h1>{sign.name}</h1>
    <div class="meta">{sign.dates} Â· {sign.element}</div>
  </div>

  <div class="sign-content">
    <p>{sign.description}</p>

    {sign.hasVideo && sign.videoCaption && (
      <div class="reading">{sign.videoCaption}</div>
    )}

    {sign.youtubeId && (
      <div class="video-embed">
        <iframe
          src={`https://www.youtube.com/embed/${sign.youtubeId}`}
          title={`${sign.name} Weekly Reading`}
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      </div>
    )}

    {!sign.hasVideo && (
      <div class="reading">ğŸŒŸ Weekly reading for {sign.name} coming soon. Follow us on YouTube and Twitter for updates!</div>
    )}
  </div>

  <div class="sign-nav">
    <a href={`${base}zodiac/${prev.slug}/`}>â† {prev.name}</a>
    <a href={`${base}zodiac/`}>All Signs</a>
    <a href={`${base}zodiac/${next.slug}/`}>{next.name} â†’</a>
  </div>
</Base>
